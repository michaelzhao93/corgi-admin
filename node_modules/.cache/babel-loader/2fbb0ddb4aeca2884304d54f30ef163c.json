{"remainingRequest":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/thread-loader/dist/cjs.js!/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/babel-loader/lib/index.js!/Users/zhaoguanglin/Documents/corgi/corgi-admin/src/utils/request.js","dependencies":[{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/src/utils/request.js","mtime":1589278308965},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _MessageBox2 from \"element-ui/lib/theme-chalk/message-box.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _MessageBox from \"element-ui/lib/message-box\";\nimport _Message2 from \"element-ui/lib/theme-chalk/message.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Message from \"element-ui/lib/message\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/web.dom.iterable\";\nimport axios from 'axios';\nimport store from '@/store';\nimport { getToken } from '@/utils/auth';\nimport { isObject } from 'util';\nimport Qs from 'qs'; // const ALLOWPARAMS = ['nickname', 'desc', 'title', 'content']\n\nvar service = axios.create({\n  baseURL: process.env.VUE_APP_BASE_API,\n  // url = base url + request url\n  // withCredentials: true, // send cookies when cross-domain requests\n  timeout: 20000,\n  transformRequest: [function () {\n    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    Object.keys(data).forEach(function (element) {\n      if (isObject(data[element])) {\n        data[element] = JSON.stringify(data[element]);\n      }\n    });\n    return Qs.stringify(data);\n  }] // paramsSerializer: function(params) {\n  //   const filter = Object.entries(params).reduce((result, item) => {\n  //     const [key, value] = item\n  //     const isValid = value || ALLOWPARAMS.some(prop => prop === key)\n  //     if (isValid) {\n  //       result[key] = value\n  //     }\n  //     return result\n  //   }, {})\n  //   return Qs.stringify(filter)\n  // }\n\n});\nservice.interceptors.request.use(function (config) {\n  if (store.getters.token) {\n    // let each request carry token\n    // ['X-Token'] is a custom headers key\n    // please modify it according to the actual situation\n    config.headers['X-Token'] = getToken();\n  }\n\n  return config;\n}, function (error) {\n  console.log(error);\n  return Promise.reject(error);\n});\nservice.interceptors.response.use( /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(response) {\n    var res;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            res = response.data;\n            _context.prev = 1;\n\n            if (!(res.code !== 0)) {\n              _context.next = 11;\n              break;\n            }\n\n            _Message({\n              message: res.message || 'Error',\n              type: 'error',\n              duration: 5 * 1000,\n              showClose: true\n            });\n\n            if (!(res.code === 50008 || res.code === 50012 || res.code === 50014)) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 7;\n            return _MessageBox.confirm('您已被登出，是否重新登录', '登出警告', {\n              confirmButtonText: '重登',\n              cancelButtonText: '取消',\n              type: 'warning',\n              showClose: true\n            });\n\n          case 7:\n            store.dispatch('user/resetToken').then(function () {\n              return location.reload();\n            });\n\n          case 8:\n            return _context.abrupt(\"return\", Promise.reject(new Error(res.message || 'Error')));\n\n          case 11:\n            return _context.abrupt(\"return\", res);\n\n          case 12:\n            _context.next = 17;\n            break;\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](1);\n            console.error(_context.t0);\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[1, 14]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}(), function (error) {\n  console.log('err' + error);\n\n  _Message({\n    message: error.message,\n    type: 'error',\n    duration: 5 * 1000,\n    showClose: true\n  });\n\n  return Promise.reject(error);\n});\nexport default service;",null]}