{"remainingRequest":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js!/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhaoguanglin/corgi-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaoguanglin/corgi-admin/src/views/dataCenter/activitytype/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaoguanglin/corgi-admin/src/views/dataCenter/activitytype/index.vue","mtime":1589958114000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _interopRequireWildcard2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/interopRequireWildcard\"));\n\nrequire(\"core-js/modules/es6.number.constructor\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/slicedToArray\"));\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/toConsumableArray\"));\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar _objectSpread2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/objectSpread2\"));\n\nvar _specifyCommon = _interopRequireDefault(require(\"../mixins/specifyCommon\"));\n\nvar _pageConfig = _interopRequireDefault(require(\"./pageConfig\"));\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  mixins: [_specifyCommon.default],\n  data: function data() {\n    return (0, _objectSpread2.default)((0, _objectSpread2.default)({}, _pageConfig.default), {}, {\n      chartRadio: 'all',\n      customizeProp: [],\n      tableHeight: 700\n    });\n  },\n  methods: {\n    parseChartData: function parseChartData() {\n      var _this = this;\n\n      this.getAllKeys();\n      this.customizeProp = [];\n      this.useProp.forEach(function (prop) {\n        return _this.baseType.some(function (type) {\n          return prop === type;\n        }) || _this.customizeProp.push(prop);\n      });\n      this.handleRadioChange();\n      this.showChart = true;\n    },\n    resetChart: function resetChart() {\n      this.chartOption.option.xAxis = [];\n      this.chartOption.option.series = [];\n      var xAxis = this.$common.deepCopy(this.xAxisTpl);\n      xAxis.data = this.chartData.map(function (chartItem) {\n        return chartItem.date;\n      });\n      this.chartOption.option.xAxis.push(xAxis);\n    },\n    allChart: function allChart() {\n      var _this2 = this;\n\n      this.resetChart();\n      this.useProp.forEach(function (prop) {\n        var series = _this2.$common.deepCopy(_this2.seriesTpl);\n\n        if (_this2.baseType.some(function (type) {\n          return prop === type;\n        })) {\n          series.name = prop;\n          series.data = _this2.chartData.map(function (item) {\n            return item[prop];\n          });\n        }\n\n        _this2.chartOption.option.series.push(series);\n      });\n\n      if (this.customizeProp.length) {\n        var series = this.$common.deepCopy(this.seriesTpl);\n        series.name = '自定义';\n        series.data = this.chartData.map(function (item) {\n          var sum = 0;\n\n          _this2.customizeProp.forEach(function (prop) {\n            sum += item[prop] || 0;\n          });\n\n          return sum;\n        });\n        this.chartOption.option.series.push(series);\n      }\n\n      this.chartOption.option.legend.data = [].concat((0, _toConsumableArray2.default)(this.useProp), ['自定义']);\n    },\n    customizeChart: function customizeChart() {\n      var _this3 = this;\n\n      this.resetChart();\n      this.customizeProp.forEach(function (prop) {\n        var series = _this3.$common.deepCopy(_this3.seriesTpl);\n\n        series.name = prop;\n        series.data = _this3.chartData.map(function (item) {\n          return item[prop];\n        });\n\n        _this3.chartOption.option.series.push(series);\n      });\n      this.chartOption.option.legend.data = this.customizeProp;\n    },\n    parseTableData: function parseTableData() {\n      var _this4 = this;\n\n      this.tableData = this.chartData.map(function (item, index) {\n        var itemData = {};\n        itemData.date = item.date;\n        itemData.children = [];\n        itemData.id = \"date-key-\".concat(index);\n        var baseData = [];\n        var manualData = [];\n        var baseTotal = 0;\n        var manualTotal = 0;\n        Object.entries(item).forEach(function (_ref) {\n          var _ref2 = (0, _slicedToArray2.default)(_ref, 2),\n              key = _ref2[0],\n              value = _ref2[1];\n\n          if (key !== 'date') {\n            if (_this4.baseType.some(function (baseKey) {\n              return baseKey === key;\n            })) {\n              baseTotal += Number(value);\n              baseData.push({\n                base: key,\n                baseValue: value\n              });\n            } else {\n              manualTotal += Number(value);\n              manualData.push({\n                manual: key,\n                manualValue: value\n              });\n            }\n          }\n        });\n        itemData.base = '基础类型总计';\n        itemData.baseValue = baseTotal;\n        itemData.manual = '自定义类型总计';\n        itemData.manualValue = manualTotal;\n        baseData.forEach(function (base, baseIndex) {\n          var id = \"date-key-\".concat(index, \"-base-\").concat(baseIndex);\n          itemData.children.push((0, _objectSpread2.default)((0, _objectSpread2.default)((0, _objectSpread2.default)({}, base), manualData.shift()), {}, {\n            id: id\n          }));\n        });\n        manualData.forEach(function (manual, manualIndex) {\n          var id = \"date-key-\".concat(index, \"-manual-\").concat(manualIndex);\n          itemData.children.push((0, _objectSpread2.default)((0, _objectSpread2.default)({}, manual), {}, {\n            id: id\n          }));\n        });\n        return itemData;\n      });\n      this.tableHead = this.baseTime.map(function (item) {\n        return _this4.$day(item).format('YYYY-MM-DD');\n      }).join(' — ');\n    },\n    handleRadioChange: function handleRadioChange(value) {\n      var status = this.chartRadio;\n      status === 'all' ? this.allChart() : this.customizeChart();\n    },\n    exportData: function exportData() {\n      var _this5 = this;\n\n      var header = ['日期', '基础类型', '总计', '自定义类型', '总计'];\n      var filename = this.tableHead + this.chartTitle;\n      var data = this.tableData.map(function (temp) {\n        var tempData = [];\n        tempData.push([temp.date, '', '', '', '']);\n        temp.children.map(function (item) {\n          var result = _this5.$common.deepCopy(item);\n\n          delete result.id;\n          var base = result.base,\n              baseValue = result.baseValue,\n              manual = result.manual,\n              manualValue = result.manualValue;\n          tempData.push(['', base, baseValue, manual, manualValue]);\n        });\n        return tempData;\n      }).flat(1);\n      Promise.resolve().then(function () {\n        return (0, _interopRequireWildcard2.default)(require('@/vendor/Export2Excel'));\n      }).then(function (excel) {\n        excel.export_json_to_excel({\n          header: header,\n          data: data,\n          filename: filename,\n          autoWidth: true,\n          bookType: 'xlsx'\n        });\n      });\n    }\n  }\n};\nexports.default = _default;",null]}