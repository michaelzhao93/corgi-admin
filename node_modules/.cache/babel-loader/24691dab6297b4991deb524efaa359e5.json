{"remainingRequest":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js!/Users/zhaoguanglin/corgi-admin/node_modules/eslint-loader/index.js??ref--13-0!/Users/zhaoguanglin/corgi-admin/src/utils/request.js","dependencies":[{"path":"/Users/zhaoguanglin/corgi-admin/src/utils/request.js","mtime":1591413993510},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _messageBox = _interopRequireDefault(require(\"element-ui/lib/theme-chalk/message-box.css\"));\n\nrequire(\"element-ui/lib/theme-chalk/base.css\");\n\nvar _messageBox2 = _interopRequireDefault(require(\"element-ui/lib/message-box\"));\n\nvar _message = _interopRequireDefault(require(\"element-ui/lib/theme-chalk/message.css\"));\n\nvar _message2 = _interopRequireDefault(require(\"element-ui/lib/message\"));\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/asyncToGenerator\"));\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar _axios = _interopRequireDefault(require(\"axios\"));\n\nvar _store = _interopRequireDefault(require(\"@/store\"));\n\nvar _auth = require(\"@/utils/auth\");\n\nvar _util = require(\"util\");\n\nvar _qs = _interopRequireDefault(require(\"qs\"));\n\n// const ALLOWPARAMS = ['nickname', 'desc', 'title', 'content']\nvar service = _axios.default.create({\n  baseURL: process.env.VUE_APP_BASE_API,\n  // url = base url + request url\n  // withCredentials: true, // send cookies when cross-domain requests\n  timeout: 20000,\n  transformRequest: [function () {\n    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    Object.keys(data).forEach(function (element) {\n      if ((0, _util.isObject)(data[element])) {\n        data[element] = JSON.stringify(data[element]);\n      }\n    });\n    return _qs.default.stringify(data);\n  }] // paramsSerializer: function(params) {\n  //   const filter = Object.entries(params).reduce((result, item) => {\n  //     const [key, value] = item\n  //     const isValid = value || ALLOWPARAMS.some(prop => prop === key)\n  //     if (isValid) {\n  //       result[key] = value\n  //     }\n  //     return result\n  //   }, {})\n  //   return Qs.stringify(filter)\n  // }\n\n});\n\nservice.interceptors.request.use(function (config) {\n  if (_store.default.getters.token) {\n    // let each request carry token\n    // please modify it according to the actual situation\n    config.headers['jwt'] = (0, _auth.getToken)();\n  }\n\n  return config;\n}, function (error) {\n  console.log(error);\n  return Promise.reject(error);\n});\nservice.interceptors.response.use( /*#__PURE__*/function () {\n  var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee(response) {\n    var res;\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            res = response.data;\n            _context.prev = 1;\n\n            if (!(res.code !== 0)) {\n              _context.next = 11;\n              break;\n            }\n\n            (0, _message2.default)({\n              message: res.message || 'Error',\n              type: 'error',\n              duration: 5 * 1000,\n              showClose: true\n            });\n\n            if (!(res.code === 50008 || res.code === 50012 || res.code === 50014)) {\n              _context.next = 8;\n              break;\n            }\n\n            _context.next = 7;\n            return _messageBox2.default.confirm('您已被登出，是否重新登录', '登出警告', {\n              confirmButtonText: '重登',\n              cancelButtonText: '取消',\n              type: 'warning',\n              showClose: true\n            });\n\n          case 7:\n            _store.default.dispatch('user/resetToken').then(function () {\n              return location.reload();\n            });\n\n          case 8:\n            return _context.abrupt(\"return\", Promise.reject(new Error(res.message || 'Error')));\n\n          case 11:\n            return _context.abrupt(\"return\", res);\n\n          case 12:\n            _context.next = 17;\n            break;\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](1);\n            console.error(_context.t0);\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[1, 14]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}(), function (error) {\n  console.log('err' + error);\n\n  _Message({\n    message: error.message,\n    type: 'error',\n    duration: 5 * 1000,\n    showClose: true\n  });\n\n  return Promise.reject(error);\n});\nvar _default = service;\nexports.default = _default;",null]}