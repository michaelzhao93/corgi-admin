{"remainingRequest":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js!/Users/zhaoguanglin/corgi-admin/node_modules/eslint-loader/index.js??ref--13-0!/Users/zhaoguanglin/corgi-admin/src/store/modules/slideBadge.js","dependencies":[{"path":"/Users/zhaoguanglin/corgi-admin/src/store/modules/slideBadge.js","mtime":1600674436906},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/slicedToArray\"));\n\nrequire(\"core-js/modules/es7.object.entries\");\n\nrequire(\"core-js/modules/es6.array.find\");\n\nrequire(\"core-js/modules/es6.reflect.set\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"regenerator-runtime/runtime\");\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"/Users/zhaoguanglin/corgi-admin/node_modules/@babel/runtime-corejs2/helpers/asyncToGenerator\"));\n\nvar _contentMgr = require(\"@/api/contentMgr\");\n\n// 设置循环定时器，执行获取计数的方法\nfunction setMethodTimer(_x) {\n  return _setMethodTimer.apply(this, arguments);\n} // 获取计数方法，要求方法名和Router中,meta下的badge值一致\n\n\nfunction _setMethodTimer() {\n  _setMethodTimer = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee8(method) {\n    var faildCount,\n        timeout,\n        _args8 = arguments;\n    return regeneratorRuntime.wrap(function _callee8$(_context8) {\n      while (1) {\n        switch (_context8.prev = _context8.next) {\n          case 0:\n            faildCount = _args8.length > 1 && _args8[1] !== undefined ? _args8[1] : 0;\n            timeout = 3000;\n            _context8.prev = 2;\n            _context8.next = 5;\n            return method();\n\n          case 5:\n            faildCount = 0;\n            _context8.next = 12;\n            break;\n\n          case 8:\n            _context8.prev = 8;\n            _context8.t0 = _context8[\"catch\"](2);\n            console.error(_context8.t0);\n\n            if (++faildCount >= 3) {\n              faildCount = 0;\n              timeout = 1000 * 60 * 5;\n            }\n\n          case 12:\n            _context8.prev = 12;\n            setTimeout(function () {\n              return setMethodTimer(method, faildCount);\n            }, timeout);\n            return _context8.finish(12);\n\n          case 15:\n          case \"end\":\n            return _context8.stop();\n        }\n      }\n    }, _callee8, null, [[2, 8, 12, 15]]);\n  }));\n  return _setMethodTimer.apply(this, arguments);\n}\n\nvar methodsMap = {\n  user: function () {\n    var _user = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              params = {\n                type: 'user'\n              };\n              _context.next = 3;\n              return (0, _contentMgr.getCountTask)(params);\n\n            case 3:\n              result = _context.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.user = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    function user() {\n      return _user.apply(this, arguments);\n    }\n\n    return user;\n  }(),\n  activity: function () {\n    var _activity = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              params = {\n                type: 'activity'\n              };\n              _context2.next = 3;\n              return (0, _contentMgr.getCountTask)(params);\n\n            case 3:\n              result = _context2.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.activity = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    function activity() {\n      return _activity.apply(this, arguments);\n    }\n\n    return activity;\n  }(),\n  avatorCensor: function () {\n    var _avatorCensor = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              params = {\n                type: 'avatar',\n                status: 'check'\n              };\n              _context3.next = 3;\n              return (0, _contentMgr.countCheckPic)(params);\n\n            case 3:\n              result = _context3.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.avatorCensor = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    function avatorCensor() {\n      return _avatorCensor.apply(this, arguments);\n    }\n\n    return avatorCensor;\n  }(),\n  activityImageCensor: function () {\n    var _activityImageCensor = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              params = {\n                type: 'activity',\n                status: 'check'\n              };\n              _context4.next = 3;\n              return (0, _contentMgr.countCheckPic)(params);\n\n            case 3:\n              result = _context4.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.activityImageCensor = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    function activityImageCensor() {\n      return _activityImageCensor.apply(this, arguments);\n    }\n\n    return activityImageCensor;\n  }(),\n  speechCensor: function () {\n    var _speechCensor = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              params = {\n                type: 'user',\n                status: 'check'\n              };\n              _context5.next = 3;\n              return (0, _contentMgr.count_check_sound)(params);\n\n            case 3:\n              result = _context5.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.speechCensor = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    function speechCensor() {\n      return _speechCensor.apply(this, arguments);\n    }\n\n    return speechCensor;\n  }(),\n  userImgCensor: function () {\n    var _userImgCensor = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              params = {\n                type: 'user',\n                status: 'check'\n              };\n              _context6.next = 3;\n              return (0, _contentMgr.countCheckPic)(params);\n\n            case 3:\n              result = _context6.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.userImgCensor = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    function userImgCensor() {\n      return _userImgCensor.apply(this, arguments);\n    }\n\n    return userImgCensor;\n  }(),\n  report: function () {\n    var _report = (0, _asyncToGenerator2.default)( /*#__PURE__*/regeneratorRuntime.mark(function _callee7() {\n      var params, result;\n      return regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              params = {\n                reportStatus: 'reported'\n              };\n              _context7.next = 3;\n              return (0, _contentMgr.countReport)(params);\n\n            case 3:\n              result = _context7.sent;\n\n              if (result && result.hasOwnProperty('data')) {\n                state.valuesMap.report = result.data;\n              }\n\n            case 5:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7);\n    }));\n\n    function report() {\n      return _report.apply(this, arguments);\n    }\n\n    return report;\n  }()\n}; // 一级菜单与二级菜单关联关系\n\nvar dotMap = {\n  contentMgr: ['user', 'activity', 'avatorCensor', 'activityImageCensor', 'userImgCensor', 'speechCensor', 'report']\n}; // 所有计数值保管对象\n\nvar valuesMap = Object.keys(methodsMap).reduce(function (map, key) {\n  Reflect.set(map, key, 0);\n  return map;\n}, {}); // 所有红点标记状态保管对象\n\nvar dotStatus = Object.keys(dotMap).reduce(function (map, key) {\n  Reflect.set(map, key, 0);\n  return map;\n}, {}); // 设置代理，设置新值时动态修改dotStatus中对应dot的状态\n\nvaluesMap = new Proxy(valuesMap, {\n  set: function set(target, key, value) {\n    Reflect.set(target, key, value);\n    var dot = Object.entries(dotMap).find(function (_ref) {\n      var _ref2 = (0, _slicedToArray2.default)(_ref, 2),\n          dot = _ref2[0],\n          badgeKeys = _ref2[1];\n\n      return badgeKeys.some(function (badge) {\n        return badge === key;\n      });\n    });\n\n    if (dot) {\n      var _dot = (0, _slicedToArray2.default)(dot, 2),\n          dotKey = _dot[0],\n          badgeKeys = _dot[1];\n\n      dotStatus[dotKey] = badgeKeys.some(function (badge) {\n        return state.valuesMap[badge];\n      });\n    }\n\n    return true;\n  }\n});\nvar state = {\n  valuesMap: valuesMap,\n  dotStatus: dotStatus\n};\nvar mutations = {\n  // 激活对应计数方法的定时器\n  ADD_ACTIVE_BADGE: function ADD_ACTIVE_BADGE(state, name) {\n    var method = methodsMap[name];\n    method && setMethodTimer(method);\n  }\n};\nvar actions = {};\nvar _default = {\n  namespaced: true,\n  state: state,\n  mutations: mutations,\n  actions: actions\n};\nexports.default = _default;",null]}