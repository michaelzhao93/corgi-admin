{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-052e8d80\"],{\"75fc\":function(t,e,a){\"use strict\";var n=a(\"a745\"),i=a.n(n),r=a(\"db2a\");function s(t){if(i()(t))return Object(r[\"a\"])(t)}var o=a(\"774e\"),c=a.n(o),l=a(\"c8bb\"),h=a.n(l),u=a(\"67bb\"),d=a.n(u);function p(t){if(\"undefined\"!==typeof d.a&&h()(Object(t)))return c()(t)}var f=a(\"e630\");function b(){throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}function m(t){return s(t)||p(t)||Object(f[\"a\"])(t)||b()}a.d(e,\"a\",(function(){return m}))},8615:function(t,e,a){var n=a(\"5ca1\"),i=a(\"504c\")(!1);n(n.S,\"Object\",{values:function(t){return i(t)}})},\"9ed2\":function(t,e,a){\"use strict\";var n=a(\"75fc\"),i=(a(\"456d\"),a(\"8615\"),a(\"ac6a\"),a(\"768b\")),r=(a(\"55dd\"),a(\"96cf\"),a(\"3b8d\")),s=(a(\"a503\"),a(\"e48d\")),o=a(\"9f2d\"),c=a(\"2817\"),l=a(\"e33a\"),h=a(\"7346\"),u=a(\"37b6\");e[\"a\"]={mixins:[l[\"a\"],h[\"a\"]],components:{Chart:c[\"a\"],dateRangePicker:s[\"a\"]},data:function(){var t=this.$day(new Date).subtract(1,\"day\").toDate();return{seriesItemColor:u[\"m\"],baseTime:[t,t],useProp:[],chartData:{},tableHeight:400,tableHead:\"\",loadingMap:{chartLoading:!1},xAxisTpl:{type:\"category\",data:[]},chartTitle:this.$route.meta.title,seriesTpl:{name:\"\",type:\"line\",smooth:!0,data:[]},chartOption:{option:{title:{text:\"\",top:\"3%\",left:\"center\"},tooltip:{trigger:\"axis\",axisPointer:{type:\"shadow\"}},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:[\"line\",\"bar\"]},restore:{show:!0},saveAsImage:{show:!0}}},dataZoom:[{show:!0,start:0,end:100,xAxisIndex:[0]},{type:\"inside\",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:\"filter\",width:30,height:\"65%\",showDataShadow:!1,left:\"93%\",top:\"100\",bottom:\"100\"}],legend:{top:\"50\",data:[]},grid:{top:\"100\",bottom:\"70\"},xAxis:[{}],yAxis:[{type:\"value\",minInterval:1}],series:[]}}}},computed:{isTimeSelected:function(){return this.baseTime.every((function(t){return t}))},chartOptionWatcher:function(){var t=this.chartOption;return t.option.title.text=this.chartTitle,t}},created:function(){this.handleChartBtnClick()},methods:{handleChartBtnClick:function(){var t=Object(r[\"a\"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.isTimeSelected){t.next=16;break}return t.prev=1,this.loadingMap.tableLoading=!0,this.loadingMap.chartLoading=!0,t.next=6,this.wrapGetChartData(this.chartType);case 6:this.chartData&&(this.parseChartData(),this.parseTableData()),t.next=12;break;case 9:t.prev=9,t.t0=t[\"catch\"](1),console.log(t.t0);case 12:return t.prev=12,this.loadingMap.tableLoading=!1,this.loadingMap.chartLoading=!1,t.finish(12);case 16:case\"end\":return t.stop()}}),t,this,[[1,9,12,16]])})));function e(){return t.apply(this,arguments)}return e}(),wrapGetChartData:function(){var t=Object(r[\"a\"])(regeneratorRuntime.mark((function t(e){var a,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getChartData(e,this.baseTime);case 2:a=t.sent,this.chartData=a.sort((function(t,e){var a=n.$day(t.date),i=n.$day(e.date);return a.isAfter(i)?1:-1}));case 4:case\"end\":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getChartData:function(){var t=Object(r[\"a\"])(regeneratorRuntime.mark((function t(e,a){var n,r,s,c,l,h=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.map((function(t){return h.$day(t).format(\"YYYY-MM-DD\")})),r=Object(i[\"a\"])(n,2),s=r[0],c=r[1],t.next=3,Object(o[\"a\"])({type:e,startDate:s,endDate:c});case 3:return l=t.sent,t.abrupt(\"return\",l.hasOwnProperty(\"data\")&&Array.isArray(l.data)&&l.data.length?l.data:[]);case 5:case\"end\":return t.stop()}}),t)})));function e(e,a){return t.apply(this,arguments)}return e}(),parseChartData:function(){var t=this;this.chartOption.option.xAxis=[],this.chartOption.option.series=[];var e=this.$common.deepCopy(this.xAxisTpl);e.data=this.chartData.map((function(t){return t.date})),this.chartOption.option.xAxis.push(e),this.getAllKeys(),this.useProp.forEach((function(e){var a=t.$common.deepCopy(t.seriesTpl);a.name=t.columnLable?t.columnLable[e]:e,a.data=t.chartData.map((function(t){return t[e]})),t.chartOption.option.series.push(a)})),this.chartOption.option.legend.data=this.columnLable?Object.values(this.columnLable):this.useProp,this.showChart=!0},getAllKeys:function(){var t=this;if(this.exceptProp){var e={};this.chartData.forEach((function(a){var n=Object.keys(a).filter((function(e){return t.exceptProp.every((function(t){return t!==e}))}));n.forEach((function(t){e[t]=1}))})),this.useProp=Object.keys(e)}else this.useProp=this.sortOrder},parseTableData:function(){var t=this;this.tableData=this.chartData,this.tableHead=this.baseTime.map((function(e){return t.$day(e).format(\"YYYY-MM-DD\")})).join(\" — \"),this.loadingMap.tableLoading=!1},exportData:function(){var t=[\"日期\"].concat(Object(n[\"a\"])(this.columnLable?Object.values(this.columnLable):this.useProp)),e=[\"date\"].concat(Object(n[\"a\"])(this.useProp)),i=this.tableHead+this.chartTitle,r=this.tableData.map((function(t){return e.map((function(e){return t[e]}))}));Promise.all([a.e(\"chunk-6e83591c\"),a.e(\"chunk-31aa43aa\"),a.e(\"chunk-58293907\")]).then(a.bind(null,\"4bf8d\")).then((function(e){e.export_json_to_excel({header:t,data:r,filename:i,autoWidth:!0,bookType:\"xlsx\"})}))}}}},\"9f2d\":function(t,e,a){\"use strict\";a.d(e,\"a\",(function(){return i})),a.d(e,\"e\",(function(){return r})),a.d(e,\"b\",(function(){return s})),a.d(e,\"c\",(function(){return o})),a.d(e,\"d\",(function(){return c}));var n=a(\"b775\");function i(t){return Object(n[\"a\"])({url:\"/tool/get_statistics\",method:\"get\",params:t})}function r(t){return Object(n[\"a\"])({url:\"/tool/sum_statistics\",method:\"get\",params:t})}function s(t){return Object(n[\"a\"])({url:\"/tool/get_user_stay\",method:\"get\",params:t})}function o(t){return Object(n[\"a\"])({url:\"/tool/get_user_trace\",method:\"get\",params:t})}function c(t){return Object(n[\"a\"])({url:\"/tool/get_influencer\",method:\"get\",params:t})}},a503:function(t,e,a){},d598:function(t,e,a){\"use strict\";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"specify-prefergroup chart-simple\"},[a(\"div\",{staticClass:\"chart\"},[a(\"div\",{staticClass:\"chart-filter flex-wrap\"},[a(\"div\",{staticClass:\"time-range-wrap flex\"},[a(\"date-range-picker\",{attrs:{\"time-range\":t.baseTime,\"default-today\":!0},on:{\"update:timeRange\":function(e){t.baseTime=e},\"update:time-range\":function(e){t.baseTime=e}}}),t._v(\" \"),a(\"el-button\",{staticClass:\"getChartData\",attrs:{type:\"primary\",size:\"small\"},on:{click:t.handleChartBtnClick}},[t._v(\"搜索\")])],1)]),t._v(\" \"),a(\"div\",{staticClass:\"page-desc\"},[t._v(t._s(t.$route.meta.title)+\"：用户日均使用时长（分）。\")]),t._v(\" \"),Object.keys(t.chartData).length?a(\"chart\",{ref:\"chart\",attrs:{\"chart-option\":t.chartOptionWatcher}}):t._e()],1),t._v(\" \"),t.tableData.length?a(\"div\",{staticClass:\"table-wrap\"},[a(\"div\",{staticClass:\"table-head flex\"},[a(\"div\",{domProps:{textContent:t._s(t.tableHead)}}),t._v(\" \"),a(\"div\",[a(\"el-button\",{attrs:{type:\"primary\",size:\"mini\"},on:{click:t.exportData}},[t._v(\"下载数据\")])],1)]),t._v(\" \"),a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loadingMap.tableLoading,expression:\"loadingMap.tableLoading\"}],ref:t.refMap.table,staticStyle:{width:\"100%\"},attrs:{data:t.tableData,border:!0,\"header-cell-style\":{textAlign:\"center\"},\"max-height\":t.tableHeight,\"default-sort\":{prop:\"date\",order:\"descending\"}}},[a(\"el-table-column\",{attrs:{sortable:\"\",label:\"日期\",prop:\"date\",align:\"center\",fixed:\"\"}}),t._v(\" \"),t._l(t.useProp,(function(e){return a(\"el-table-column\",{key:\"table-column-\"+e,attrs:{sortable:\"\",label:t.columnLable[e],prop:e,align:\"center\"}})}))],2)],1):t._e()])},i=[],r=(a(\"ffc1\"),a(\"ac6a\"),a(\"768b\")),s=(a(\"96cf\"),a(\"3b8d\")),o=a(\"db72\"),c=a(\"9f2d\"),l=a(\"9ed2\"),h={chartType:\"prefergroup\",sortOrder:[\"total\",\"user\",\"follow\",\"activity\",\"favor\"],columnLable:{total:\"全部\",activity:\"活动\",favor:\"收藏\",follow:\"可基\",user:\"基达\"}},u={mixins:[l[\"a\"]],data:function(){return Object(o[\"a\"])({},h)},methods:{getChartData:function(){var t=Object(s[\"a\"])(regeneratorRuntime.mark((function t(e,a){var n,i,s,o,l,h=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=a.map((function(t){return h.$day(t).format(\"YYYY-MM-DD\")})),i=Object(r[\"a\"])(n,2),s=i[0],o=i[1],t.next=3,Object(c[\"c\"])({startDate:s,endDate:o});case 3:return l=t.sent,t.abrupt(\"return\",l.hasOwnProperty(\"data\")&&Array.isArray(l.data)?this.parseData(l.data):[]);case 5:case\"end\":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),parseData:function(t){var e={};return t.forEach((function(t){var a=t.date,n=t.time,i=t.type;a&&!e.hasOwnProperty(a)&&(e[a]={}),a&&(i||0===i)&&(e[a][i]=n)})),Object.entries(e).map((function(t){var e=Object(r[\"a\"])(t,2),a=e[0],n=e[1],i={date:a};return Object.entries(n).forEach((function(t){var e=Object(r[\"a\"])(t,2),a=e[0],n=e[1];i[a]=n})),i}))}}},d=u,p=a(\"2877\"),f=Object(p[\"a\"])(d,n,i,!1,null,null,null);e[\"default\"]=f.exports},e33a:function(t,e,a){\"use strict\";a(\"f6b3\"),a(\"ac6a\"),a(\"456d\");var n=a(\"9abb\"),i={components:{Paginationtpl:n[\"a\"]},data:function(){return{pagination:{page:1,pageSize:10},paginationTotal:0}},watch:{pagination:{handler:function(){this.getData()},deep:!0}},methods:{resetPagination:function(){this.pagination={page:1,pageSize:10}}}};e[\"a\"]={mixins:[i],data:function(){return{refMap:{table:\"mainTable\"},tableData:[],catchedDataArr:[],catchedData:{},catchedRadio:null,tableSelected:!1,tableHeight:200,extraHeight:110,loadingMap:{tableLoading:!1},visibleMap:{tableVisible:!1},renderMap:{tableRender:!1},switchMap:{getDataOnRender:!0}}},computed:{isTableRadioSelected:function(){return Object.keys(this.catchedData).length},isTableCheckBoxSelected:function(){return this.catchedDataArr.length>0}},mounted:function(){Reflect.has(this,\"getData\")&&this.switchMap.getDataOnRender&&this.getData()},watch:{\"loadingMap.tableLoading\":function(t){var e=this;t||this.$nextTick((function(){var t=e.$refs[e.refMap.table];t&&t.doLayout()}))}},methods:{handleTableCheckBoxSelect:function(t){this.catchedDataArr=t,this.tableSelected=this.$refs[this.refMap.table].selection.length>0},handleTabelRadioClick:function(t){this.catchedRadio=t,this.catchedData=this.tableData[t]},handleTableItemClick:function(t){this.catchedData=t},setTableHeightBySelf:function(){var t=this.minTableHeight,e=void 0===t?0:t,a=this.$refs[this.searchRef],n=a&&a.$el.clientHeight||0,i=this.$el.clientHeight-this.extraHeight-n;this.tableHeight=i<e?e:i},setTableHeightByParent:function(){var t=this.minTableHeight,e=void 0===t?0:t,a=this.$refs[this.searchRef],n=a&&a.$el.clientHeight||0,i=this.$parent.$el.clientHeight-this.extraHeight-n;this.tableHeight=i<e?e:i},watchResizeFinish:function(t,e){var a=this;return clearTimeout(e),e=setTimeout((function(){return new Promise((function(e){a.renderMap.tableRender=!0,e(t()),a.$nextTick((function(){setTimeout((function(){a.renderMap.tableRender=!1}),100)}))}))}),100),e},addTabelHeightListener:function(){var t,e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"self\",n=\"self\"===a?this.$el:this.$parent.$el,i=\"self\"===a?this.setTableHeightBySelf:this.setTableHeightByParent;this.$erd.listenTo(n,(function(a){e.renderMap.tableRender||(t=e.watchResizeFinish(i,t))}))},isTableSelected:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"请先选择需要修改的数据\";return!(!this.isTableRadioSelected&&!this.isTableCheckBoxSelected)||(this.$message({type:\"warning\",message:t}),!1)},formatColumn:function(t,e,a,n){return null===a||\"\"===a||void 0===a?\"--\":a}},beforeDestroy:function(){this.$erd.removeAllListeners(this.$el)}}},e48d:function(t,e,a){\"use strict\";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"el-date-picker\",{attrs:{type:t.type,align:\"right\",\"unlink-panels\":\"\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\",\"picker-options\":t.pickerOptions,size:\"small\"},model:{value:t.pickTimeRange,callback:function(e){t.pickTimeRange=e},expression:\"pickTimeRange\"}})},i=[],r=a(\"37b6\"),s={props:{type:{type:String,default:\"daterange\"},timeRange:{type:Array,default:function(){return[]}},defaultToday:{type:Boolean,default:!1}},data:function(){return{pickerOptions:r[\"l\"],pickTimeRange:[]}},watch:{pickTimeRange:function(t){this.$emit(\"update:timeRange\",t)}},created:function(){if(this.defaultToday){var t=this.$day(new Date).subtract(1,\"day\").toDate();this.pickTimeRange=[t,t]}else{var e=new Date;this.pickTimeRange=[this.$day(e).subtract(30,\"day\").toDate(),e]}}},o=s,c=a(\"2877\"),l=Object(c[\"a\"])(o,n,i,!1,null,null,null);e[\"a\"]=l.exports},f6b3:function(t,e,a){var n=a(\"5ca1\");n(n.S,\"Reflect\",{has:function(t,e){return e in t}})}}]);","extractedComments":[]}