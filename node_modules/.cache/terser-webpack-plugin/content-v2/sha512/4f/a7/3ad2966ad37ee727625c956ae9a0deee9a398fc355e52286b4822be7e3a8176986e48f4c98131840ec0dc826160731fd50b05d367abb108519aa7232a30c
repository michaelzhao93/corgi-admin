{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-20ffae39\"],{8615:function(t,e,a){var n=a(\"5ca1\"),i=a(\"504c\")(!1);n(n.S,\"Object\",{values:function(t){return i(t)}})},\"9f2d\":function(t,e,a){\"use strict\";a.d(e,\"a\",(function(){return i})),a.d(e,\"e\",(function(){return r})),a.d(e,\"b\",(function(){return s})),a.d(e,\"c\",(function(){return o})),a.d(e,\"d\",(function(){return c}));var n=a(\"b775\");function i(t){return Object(n[\"a\"])({url:\"/tool/get_statistics\",method:\"get\",params:t})}function r(t){return Object(n[\"a\"])({url:\"/tool/sum_statistics\",method:\"get\",params:t})}function s(t){return Object(n[\"a\"])({url:\"/tool/get_user_stay\",method:\"get\",params:t})}function o(t){return Object(n[\"a\"])({url:\"/tool/get_user_trace\",method:\"get\",params:t})}function c(t){return Object(n[\"a\"])({url:\"/tool/get_influencer\",method:\"get\",params:t})}},a503:function(t,e,a){},a5ca:function(t,e,a){\"use strict\";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"dataCenter-dau chart-simple\"},[a(\"div\",{staticClass:\"chart\"},[a(\"div\",{staticClass:\"chart-filter flex-wrap\"},[a(\"div\",{staticClass:\"time-range-wrap flex\"},[a(\"date-range-picker\",{attrs:{\"time-range\":t.baseTimeRange},on:{\"update:timeRange\":function(e){t.baseTimeRange=e},\"update:time-range\":function(e){t.baseTimeRange=e}}}),t._v(\" \"),a(\"el-button\",{staticClass:\"getChartData\",attrs:{type:\"primary\",size:\"small\"},on:{click:t.handleChartBtnClick}},[t._v(\"搜索\")])],1),t._v(\" \"),a(\"div\",[a(\"el-checkbox\",{model:{value:t.MOM,callback:function(e){t.MOM=e},expression:\"MOM\"}},[t._v(\"环比\")]),t._v(\" \"),a(\"el-checkbox\",{model:{value:t.YOY,callback:function(e){t.YOY=e},expression:\"YOY\"}},[t._v(\"同比\")])],1)]),t._v(\" \"),Object.keys(t.chartData).length?a(\"chart\",{ref:\"chart\",attrs:{\"chart-option\":t.chartOptionWatcher}}):t._e()],1),t._v(\" \"),t.tableData.length?a(\"div\",{staticClass:\"table-wrap\"},[a(\"div\",{staticClass:\"table-head flex\"},[a(\"div\",{domProps:{textContent:t._s(t.tableHead)}}),t._v(\" \"),a(\"div\",[a(\"el-button\",{attrs:{type:\"primary\",size:\"mini\"},on:{click:t.exportData}},[t._v(\"下载数据\")])],1)]),t._v(\" \"),a(\"div\",{staticClass:\"tabel-height-400\"},[a(\"vue-scroll\",[a(\"el-table\",{directives:[{name:\"loading\",rawName:\"v-loading\",value:t.loadingMap.tableLoading,expression:\"loadingMap.tableLoading\"}],ref:t.refMap.table,staticStyle:{width:\"100%\"},attrs:{data:t.tableData,border:!0,\"header-cell-style\":{textAlign:\"center\"},\"row-key\":\"index\",\"tree-props\":{children:\"children\",hasChildren:\"hasChildren\"},\"default-sort\":{prop:\"date\",order:\"descending\"}}},[a(\"el-table-column\",{attrs:{sortable:\"\",label:\"日期\",align:\"center\",prop:\"date\"}}),t._v(\" \"),a(\"el-table-column\",{attrs:{sortable:\"\",label:\"DAU\",align:\"center\",prop:\"dau\"}}),t._v(\" \"),t.tableMOM?a(\"el-table-column\",{attrs:{sortable:\"\",label:\"MOM\",align:\"center\",prop:\"MOM\"}}):t._e(),t._v(\" \"),t.tableYOY?a(\"el-table-column\",{attrs:{sortable:\"\",label:\"YOY\",align:\"center\",prop:\"YOY\"}}):t._e()],1)],1)],1)]):t._e()])},i=[],r=(a(\"456d\"),a(\"7514\"),a(\"8615\"),a(\"ffc1\"),a(\"768b\")),s=(a(\"ac6a\"),a(\"5df3\"),a(\"96cf\"),a(\"3b8d\")),o=(a(\"a503\"),a(\"9f2d\")),c=a(\"e48d\"),l=a(\"2817\"),h=a(\"7346\"),u=a(\"e33a\"),d={data:function(){return{chartType:\"dau\",allChartType:[{label:\"dau\",text:\"基准\"},{label:\"MOM\",text:\"环比\"},{label:\"YOY\",text:\"同比\"}],baseTimeRange:[],MOM:!1,YOY:!1,chartData:{},tableHead:\"\",tableMOM:!1,tableYOY:!1,xAxisTpl:{type:\"category\",axisTick:{alignWithLabel:!0},axisLine:{onZero:!0},data:[]},seriesTpl:{name:\"\",type:\"line\",smooth:!0,data:[]},chartOption:{option:{title:{text:\"DAU统计\",top:\"3%\",left:\"center\"},tooltip:{trigger:\"axis\",axisPointer:{type:\"cross\",label:{show:!0,precision:0}},formatter:function(t){return t.map((function(t){return'<div class=\"flex chart-tool-item\">\\n                          <div class=\"chart-tool-icon\" style=\"background-color:'.concat(t.color,';\"></div>\\n                          <div>').concat(t.seriesName,\" : \").concat(t.value,\"</div>\\n                        </div>\")})).join(\"\")}},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:[\"line\",\"bar\"]},restore:{show:!0},saveAsImage:{show:!0}}},dataZoom:[{show:!0,start:0,end:100,xAxisIndex:[0]},{type:\"inside\",start:0,end:100},{show:!0,yAxisIndex:0,filterMode:\"filter\",width:30,height:\"55%\",showDataShadow:!1,left:\"93%\",top:\"30%\"}],legend:{data:[\"基准\",\"同比\",\"环比\"],top:\"12%\"},grid:{top:\"30%\",bottom:\"15%\"},xAxis:[{}],yAxis:[{type:\"value\"}],series:[]}}}}},p={components:{dateRangePicker:c[\"a\"],Chart:l[\"a\"]},mixins:[h[\"a\"],u[\"a\"],d],data:function(){return{loadingMap:{statsLoading:!0},contrast:!1,extraHeight:350}},computed:{chartOptionWatcher:function(){return this.chartOption},isTimeRangeSelected:function(){return this.baseTimeRange.length>=2}},watch:{},mounted:function(){this.addTabelHeightListener(\"parent\")},methods:{getData:function(){var t=Object(s[\"a\"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=[],this.isTimeRangeSelected&&e.push(this.handleChartBtnClick()),t.next=5,Promise.all(e);case 5:t.next=10;break;case 7:t.prev=7,t.t0=t[\"catch\"](0),console.log(t.t0);case 10:case\"end\":return t.stop()}}),t,this,[[0,7]])})));function e(){return t.apply(this,arguments)}return e}(),handleChartBtnClick:function(){var t=Object(s[\"a\"])(regeneratorRuntime.mark((function t(){var e,a,n,i,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.isTimeRangeSelected){t.next=16;break}return t.prev=1,e=[],a=this.baseTimeRange.map((function(t){return r.$day(t).format(\"YYYY-MM-DD\")})),e.push(this.getChartData(\"dau\",a)),this.MOM&&(n=this.baseTimeRange.map((function(t){return r.$day(t).subtract(1,\"month\").format(\"YYYY-MM-DD\")})),e.push(this.getChartData(\"MOM\",n))),this.YOY&&(i=this.baseTimeRange.map((function(t){return r.$day(t).subtract(1,\"year\").format(\"YYYY-MM-DD\")})),e.push(this.getChartData(\"YOY\",i))),t.next=9,Promise.all(e);case 9:this.parseChartData(),this.parseTableData(),t.next=16;break;case 13:t.prev=13,t.t0=t[\"catch\"](1),console.log(t.t0);case 16:case\"end\":return t.stop()}}),t,this,[[1,13]])})));function e(){return t.apply(this,arguments)}return e}(),getChartData:function(){var t=Object(s[\"a\"])(regeneratorRuntime.mark((function t(e,a){var n,i,s,c,l,h;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.chartType,i=Object(r[\"a\"])(a,2),s=i[0],c=i[1],t.next=4,Object(o[\"a\"])({type:n,startDate:s,endDate:c});case 4:l=t.sent,h=l.hasOwnProperty(\"data\")&&Array.isArray(l.data)?l.data:[],this.chartData[e]=h.reduce((function(t,e){return t[e.date]=e,t}),{});case 7:case\"end\":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),parseChartData:function(){var t=this;this.chartOption.option.xAxis=[],this.chartOption.option.series=[],this.chartOption.option.dataZoom[0].xAxisIndex=[],Object.entries(this.chartData).forEach((function(e,a){var n=t.$common.deepCopy(t.xAxisTpl),i=t.$common.deepCopy(t.seriesTpl),s=Object(r[\"a\"])(e,2),o=s[0],c=s[1];Object.values(c).forEach((function(e,a){if(\"dau\"===o)n.data.push(e.date),i.data.push(e.count);else{var r;\"MOM\"===o?r=t.$day(e.date).add(1,\"month\").format(\"YYYY-MM-DD\"):\"YOY\"===o&&(r=t.$day(e.date).add(1,\"year\").format(\"YYYY-MM-DD\"));var s,c=t.chartData.dau[r],l=c&&c.hasOwnProperty(\"count\")?e.count-c.count:\"--\";if(\"--\"===l)s=\"--\";else{var h=e.count;s=0===h?0===l?\"0%\":(h+1)*l*100+\"%\":0===l?(h-1)*l*100+\"%\":100*(l/h).toFixed(2)+\"%\"}i.data.push(s)}})),i.name=t.allChartType.find((function(t){return o===t.label})).text,t.chartOption.option.xAxis.push(n),t.chartOption.option.series.push(i),t.chartOption.option.dataZoom[0].xAxisIndex.push(a)})),this.showChart=!0},parseTableData:function(){var t=this;this.loadingMap.tableLoading=!0,this.tableData=[];var e=Object.keys(this.chartData),a=e[0],n=Object.values(this.chartData[a]);n.forEach((function(a,n){var i={};i.date=a.date,e.forEach((function(e,n){if(\"dau\"===e)i.dau=a.count;else{var r;\"MOM\"===e?r=t.$day(i.date).subtract(1,\"month\").format(\"YYYY-MM-DD\"):\"YOY\"===e&&(r=t.$day(i.date).subtract(1,\"year\").format(\"YYYY-MM-DD\"));var s=t.chartData[e][r];i[e]=s&&s.hasOwnProperty(\"count\")?s.count:\"--\"}})),t.tableData.push(i)})),this.tableMOM=this.chartData.hasOwnProperty(\"MOM\"),this.tableYOY=this.chartData.hasOwnProperty(\"YOY\"),this.tableSortable=!0,this.dateAlign=\"center\",this.tableHead=this.baseTimeRange.map((function(e){return t.$day(e).format(\"YYYY-MM-DD\")})).join(\" 至 \"),this.loadingMap.tableLoading=!1},exportData:function(){var t=[\"日期\",\"DAU\"];this.tableMOM&&t.push(\"环比\"),this.tableYOY&&t.push(\"同比\");var e=\"DAU统计表\",n=this.tableData.map((function(t){return Object.values(t)}));Promise.all([a.e(\"chunk-6e83591c\"),a.e(\"chunk-0e676f82\"),a.e(\"chunk-22909c13\")]).then(a.bind(null,\"4bf8d\")).then((function(a){a.export_json_to_excel({header:t,data:n,filename:e,autoWidth:!0,bookType:\"xlsx\"})}))},isContrast:function(){this.contrast=!this.contrast}}},f=p,b=a(\"2877\"),g=Object(b[\"a\"])(f,n,i,!1,null,null,null);e[\"default\"]=g.exports},e33a:function(t,e,a){\"use strict\";a(\"f6b3\"),a(\"ac6a\"),a(\"456d\");var n=a(\"9abb\"),i={components:{Paginationtpl:n[\"a\"]},data:function(){return{pagination:{page:1,pageSize:10},paginationTotal:0}},watch:{pagination:{handler:function(){this.getData()},deep:!0}},methods:{resetPagination:function(){this.pagination={page:1,pageSize:10}}}};e[\"a\"]={mixins:[i],data:function(){return{refMap:{table:\"mainTable\"},tableData:[],catchedDataArr:[],catchedData:{},catchedRadio:null,tableSelected:!1,tableHeight:200,extraHeight:110,loadingMap:{tableLoading:!1},visibleMap:{tableVisible:!1},renderMap:{tableRender:!1},switchMap:{getDataOnRender:!0}}},computed:{isTableRadioSelected:function(){return Object.keys(this.catchedData).length},isTableCheckBoxSelected:function(){return this.catchedDataArr.length>0}},mounted:function(){Reflect.has(this,\"getData\")&&this.switchMap.getDataOnRender&&this.getData()},watch:{\"loadingMap.tableLoading\":function(t){var e=this;t||this.$nextTick((function(){var t=e.$refs[e.refMap.table];t&&t.doLayout()}))}},methods:{handleTableCheckBoxSelect:function(t){this.catchedDataArr=t,this.tableSelected=this.$refs[this.refMap.table].selection.length>0},handleTabelRadioClick:function(t){this.catchedRadio=t,this.catchedData=this.tableData[t]},handleTableItemClick:function(t){this.catchedData=t},setTableHeightBySelf:function(){var t=this.minTableHeight,e=void 0===t?0:t,a=this.$refs[this.searchRef],n=a&&a.$el.clientHeight||0,i=this.$el.clientHeight-this.extraHeight-n;this.tableHeight=i<e?e:i},setTableHeightByParent:function(){var t=this.minTableHeight,e=void 0===t?0:t,a=this.$refs[this.searchRef],n=a&&a.$el.clientHeight||0,i=this.$parent.$el.clientHeight-this.extraHeight-n;this.tableHeight=i<e?e:i},watchResizeFinish:function(t,e){var a=this;return clearTimeout(e),e=setTimeout((function(){return new Promise((function(e){a.renderMap.tableRender=!0,e(t()),a.$nextTick((function(){setTimeout((function(){a.renderMap.tableRender=!1}),100)}))}))}),100),e},addTabelHeightListener:function(){var t,e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"self\",n=\"self\"===a?this.$el:this.$parent.$el,i=\"self\"===a?this.setTableHeightBySelf:this.setTableHeightByParent;this.$erd.listenTo(n,(function(a){e.renderMap.tableRender||(t=e.watchResizeFinish(i,t))}))},isTableSelected:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"请先选择需要修改的数据\";return!(!this.isTableRadioSelected&&!this.isTableCheckBoxSelected)||(this.$message({type:\"warning\",message:t}),!1)},formatColumn:function(t,e,a,n){return null===a||\"\"===a||void 0===a?\"--\":a}},beforeDestroy:function(){this.$erd.removeAllListeners(this.$el)}}},e48d:function(t,e,a){\"use strict\";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"el-date-picker\",{attrs:{type:t.type,align:\"right\",\"unlink-panels\":\"\",\"range-separator\":\"至\",\"start-placeholder\":\"开始日期\",\"end-placeholder\":\"结束日期\",\"picker-options\":t.pickerOptions,size:\"small\"},model:{value:t.pickTimeRange,callback:function(e){t.pickTimeRange=e},expression:\"pickTimeRange\"}})},i=[],r=a(\"37b6\"),s={props:{type:{type:String,default:\"daterange\"},timeRange:{type:Array,default:function(){return[]}},defaultToday:{type:Boolean,default:!1}},data:function(){return{pickerOptions:r[\"l\"],pickTimeRange:[]}},watch:{pickTimeRange:function(t){this.$emit(\"update:timeRange\",t)}},created:function(){if(this.defaultToday){var t=this.$day(new Date).subtract(1,\"day\").toDate();this.pickTimeRange=[t,t]}else{var e=new Date;this.pickTimeRange=[this.$day(e).subtract(30,\"day\").toDate(),e]}}},o=s,c=a(\"2877\"),l=Object(c[\"a\"])(o,n,i,!1,null,null,null);e[\"a\"]=l.exports},f6b3:function(t,e,a){var n=a(\"5ca1\");n(n.S,\"Reflect\",{has:function(t,e){return e in t}})}}]);","extractedComments":[]}