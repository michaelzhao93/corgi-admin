{"remainingRequest":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaoguanglin/Documents/corgi/corgi-admin/src/views/contentMgr/activity/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/src/views/contentMgr/activity/index.vue","mtime":1586103940000},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/Documents/corgi/corgi-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { mapMutations } from 'vuex'\r\nimport { queryActivity, countActivity, removeActivity } from '@/api/contentMgr'\r\nimport Userid from '@/components/Userid'\r\nimport Activitystatus from '@/components/Activitystatus'\r\nimport Checkstatus from '@/components/Checkstatus'\r\nimport Detail from './Detail'\r\nimport tableCommon from '@/mixins/tableCommon'\r\nimport { emit } from '@/mixins/commonSet'\r\nimport contentMgrCommon from '../mixins/common'\r\nimport { allActivityStatus, allActivityCheckStatus } from '@/utils/const'\r\nimport pageConfig from './pageConfig'\r\nexport default {\r\n  components: { Activitystatus, Checkstatus, Detail, Userid },\r\n  mixins: [tableCommon, emit, contentMgrCommon],\r\n  data() {\r\n    return {\r\n      allActivityStatus,\r\n      allActivityCheckStatus,\r\n      ...pageConfig,\r\n      visibleMap: {\r\n        censorDiaVisible: false,\r\n        detailDiaVisible: false\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    activityShow() {\r\n      return this.$store.getters.activityShow\r\n    }\r\n  },\r\n  watch: {\r\n    activityShow(value) {\r\n      !value && this.getData()\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations('activityInfo', {\r\n      'setShow': 'SET_SHOW',\r\n      'setActivityId': 'SET_ACTIVITY_ID'\r\n    }),\r\n    async getData() {\r\n      try {\r\n        this.loadingMap.tableLoading = true\r\n        const task = [this.getActivity(), this.getActivityCount()]\r\n        await Promise.all(task)\r\n      } catch (err) {\r\n        console.log(err)\r\n      } finally {\r\n        this.loadingMap.tableLoading = false\r\n      }\r\n    },\r\n    async getActivity() {\r\n      try {\r\n        const data = await queryActivity({ ...this.searchForm, ...this.pagination })\r\n        this.tableData = data.data\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    },\r\n    async getActivityCount() {\r\n      try {\r\n        const data = await countActivity({ ...this.searchForm })\r\n        this.paginationTotal = data.data\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    },\r\n    async handleActivityDetail(data) {\r\n      const { id } = data\r\n      if (id) {\r\n        this.setActivityId(id)\r\n        this.setShow(true)\r\n      }\r\n    },\r\n    async handleActivityRemove(data) {\r\n      try {\r\n        await this.$msgbox.confirm(`确定删除活动：<span class=\"bold\">${data.title}</span>`, '删除活动', {\r\n          confirmButtonText: '删除',\r\n          cancelButtonText: '取消',\r\n          type: 'warning',\r\n          dangerouslyUseHTMLString: true\r\n        })\r\n        const activityId = data.id\r\n        await removeActivity({ activityId })\r\n        this.$message({ type: 'success', message: '删除成功' })\r\n        this.getData()\r\n      } catch (err) {\r\n        err !== 'cancel' && console.log(err)\r\n      }\r\n    }\r\n  }\r\n}\r\n",null]}