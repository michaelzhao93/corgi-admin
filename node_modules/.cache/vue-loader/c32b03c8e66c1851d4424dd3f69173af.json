{"remainingRequest":"/Users/zhaoguanglin/corgi-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhaoguanglin/corgi-admin/src/views/contentMgr/speechCensor/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhaoguanglin/corgi-admin/src/views/contentMgr/speechCensor/index.vue","mtime":1600680098849},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhaoguanglin/corgi-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { get_check_sound, count_check_sound, pass_sound, refuse_sound ,add_system_message} from '@/api/contentMgr'\r\nimport Censorshipstatus from '@/components/Censorshipstatus'\r\nimport Userid from '@/components/Userid'\r\nimport tableCommon from '@/mixins/tableCommon'\r\nimport contentMgrCommon from '../mixins/common'\r\nimport { allCensorshipTypes } from '@/utils/const'\r\nimport pageConfig from './pageConfig'\r\nvar BenzAMRRecorder = require('benz-amr-recorder');\r\n\r\nexport default {\r\n  components: { Censorshipstatus, Userid },\r\n  mixins: [tableCommon, contentMgrCommon],\r\n  data() {\r\n    return {\r\n      allCensorshipTypes,\r\n      ...pageConfig\r\n    }\r\n  },\r\n  methods: {\r\n    async getData() {\r\n      try {\r\n        this.loadingMap.tableLoading = true\r\n        const task = [this.get_check_sound(), this.count_check_sound()]\r\n        await Promise.all(task)\r\n      } catch (err) {\r\n        console.log(err)\r\n      } finally {\r\n        this.loadingMap.tableLoading = false\r\n      }\r\n    },\r\n    async get_check_sound() {\r\n      try {\r\n        const type = this.censorType\r\n        const data = await get_check_sound({ ...this.searchForm, ...this.pagination})\r\n        this.tableData = data.data.map(item => {\r\n\r\n\r\n                  console.log(item)\r\n          return item\r\n        })\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    },\r\n    async count_check_sound() {\r\n      try {\r\n        const type = this.censorType\r\n        const data = await count_check_sound({ ...this.searchForm, type })\r\n        this.paginationTotal = data.data\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    },\r\n    async checkPicPass(scope) {\r\n      try {\r\n        const { dataId } = scope.row\r\n        const userId = -1\r\n        await pass_sound({ dataId, userId })\r\n        this.$message({ type: 'success', message: '操作成功' })\r\n        this.getData()\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    },\r\n        async playMusic(scope) {\r\n\r\nthis.audio = new Audio();\r\n    this.audio.src = scope.row.soundUrl;\r\n    let playPromise;\r\n    let second = 10;\r\n    \r\n   //加载音频\r\n    playPromise = this.audio.play();\r\n\r\n    },\r\n    async checkPicRefuse(scope) {\r\n      try {\r\n        await this.$msgbox.confirm('确定不通过该语音', '提醒', {\r\n          confirmButtonText: '删除',\r\n          cancelButtonText: '取消',\r\n          type: 'warning',\r\n          dangerouslyUseHTMLString: true\r\n        })\r\n        const { dataId } = scope.row\r\n        const userId = -1\r\n        await refuse_sound({ dataId, userId })\r\n        this.sendmessage(scope.row.userId);\r\n        this.$message({ type: 'success', message: '操作成功' })\r\n        this.getData()\r\n      } catch (err) {\r\n        err !== 'cancel' && console.log(err)\r\n      }\r\n    },\r\n        async sendmessage(id) {\r\n\r\n      let content =  '很抱歉~您发送的语音审核失败咯，快调整下姿势重新来过吧';\r\n      let sentTime =  0;\r\n      let title =  '给'+id+'发的审核通知';\r\n      let status = \"created\";\r\n      let rules = [\r\n      {\r\n        ruleKey: \"userId\",\r\n        ruleValue: id\r\n      }]\r\n      let data = ({ content: content, status: status, sentTime: sentTime, title: title, rules: rules});\r\n      console.log(data)\r\n      add_system_message(data);\r\n    }\r\n  }\r\n}\r\n",null]}